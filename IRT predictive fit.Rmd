---
title: "Replicate Ben's IRT paper"
author: "radhika"
date: "1/21/2021"
output: html_document
---







```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}

#install.packages("dplyr")
library(tidyr)
library(dplyr)
library(stringr) 
library(ggplot2)
library(readr)
library(norm)
library(knitr)


#install.packages("psych")
library(psych)
library(mirt)


#install.packages("lmtest")
library(lmtest)
```


### Generate data
nitem=50
sample.size=1000

a <- as.matrix(round(rlnorm(nitem, meanlog = 0, sdlog = 1),3), ncol=1) #lognormal
b <- as.matrix(round(rnorm(nitem, mean = 0, sd = 1),3), ncol=1) #normal
c <- as.matrix(round(rbeta(nitem, shape1 = 5, shape2 = 17),3), ncol=1) #beta
ability <- as.matrix(round(rnorm(sample.size, mean = 0, sd = 1),3), ncol=1)
  
dat <- as.data.frame(simdata(a = a, 
                d = b, 
                N = sample.size, 
                itemtype = '3PL', 
                guess = c, 
                Theta = ability))


### break into test and train
dat$id <- 1:nrow(dat)
dat_train <- dat %>% 
    dplyr::sample_frac(.75)
dat_test  <- dplyr::anti_join(dat, dat_train, by = 'id')


### Fit 1PL, 2PL, 3PL to train
#estimate IRT parameters
model1PL <- mirt(data=dat_train, 1, itemtype='Rasch', SE=TRUE, verbose=FALSE)
model2PL <- mirt(data=dat_train, 1, itemtype='2PL', SE=TRUE, verbose=FALSE)
model3PL <- mirt(data=dat_train, 1, itemtype='3PL', SE=TRUE, verbose=FALSE)


### Fit AIC/ BIC








### Split into train and test


